name: Generate Release JSON
description: Generate a new release JSON file for { TAG_NAME_FILTER }

inputs:
  TOKEN:
    required: true
  BRANCH:
    required: true
  REPOSITORY:
    required: true
  MAINTAIN_USERNAME:
    required: true
  MAINTAIN_EMAIL:
    required: true
  TAG_NAME_FILTER:
    required: true

runs:
  using: "composite"
  steps:
    - name: Checkout next release branch
      uses: actions/checkout@v3
      with:
        ref: ${{ inputs.BRANCH }}
    - shell: bash
      env:
        TOKEN: ${{ inputs.TOKEN }}
        REPOSITORY: ${{ inputs.REPOSITORY }}
        BRANCH: ${{ inputs.BRANCH }}
        MAINTAIN_USERNAME: ${{ inputs.MAINTAIN_USERNAME }}
        MAINTAIN_EMAIL: ${{ inputs.MAINTAIN_EMAIL }}
        TAG_NAME_FILTER: ${{ inputs.TAG_NAME_FILTER }}
      run: |
            npm install --no-package-lock --no-save @octokit/rest@19.0.3
            node .github/workflows/generate-release-json/generate-release-json.js
            git config user.name ${{ inputs.MAINTAIN_USERNAME }}
            git config user.email ${{ inputs.MAINTAIN_EMAIL }}
            git add releases/*.json
            git commit -am "Generate release JSON"
            git push origin ${{ inputs.BRANCH }}
